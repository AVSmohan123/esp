<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AVS.MOHAN - Control Panel</title>

<style>
:root{
 --aqua1: rgba(0,255,255,0.20);
 --aqua2: rgba(0,180,255,0.35);
 --aqua3: rgba(0,140,255,0.55);
 --glass-border: rgba(255,255,255,0.25);
 --bg:#071017;
 --radius:14px;
 --digital:'Courier New', monospace;
}

html,body{
 margin:0;
 background:var(--bg);
 font-family:Inter;
 color:white;
}

/* Container */
.container{
 padding:6px;
 max-width:1100px;
 margin:auto;
}

/* GRID */
.grid{ display:grid; gap:6px; }
.row-1{ grid-template-columns:repeat(4,1fr); }
.row-2{ grid-template-columns:repeat(3,1fr); }

/* CARD */
.card{
 background: linear-gradient(135deg,var(--aqua1),var(--aqua2));
 border:1px solid var(--glass-border);
 border-radius:var(--radius);
 padding:6px;
 text-align:center;
 backdrop-filter:blur(10px);
 box-shadow:0 4px 14px rgba(0,255,255,0.15);
}
.card.small{ min-height:70px; }

.title{ font-size:10px; opacity:.85; margin-bottom:4px; }
.icon{ font-size:18px; margin-bottom:2px; }
.big-value{
 font-family:var(--digital);
 font-size:18px;
 margin-top:2px;
}

/* BUTTONS */
.glass-btn{
 background: linear-gradient(135deg,var(--aqua2),var(--aqua3));
 border:1px solid var(--glass-border);
 border-radius:12px;
 padding:6px;
 color:white;
 cursor:pointer;
 font-weight:700;
 transition:.15s;
}
.glass-btn:hover{
 transform:scale(1.05);
 box-shadow:0 0 15px rgba(0,255,255,0.25);
}

.green{ background:linear-gradient(135deg,#0ff,#0ac); }
.red{ background:linear-gradient(135deg,#f55,#d22); }

.badge{
 background:#ffffff28;
 padding:4px 6px;
 border-radius:12px;
 font-family:var(--digital);
 font-size:18px;
 font-weight:700;
}

.hidden{ display:none!important; }

.row-sep{
 height:1px;
 background:#ffffff20;
 margin:10px 0;
 border-radius:4px;
}

/* Sticky Header */
#header{
 position:fixed;
 top:0;left:0;width:100%;
 background:rgba(7,16,23,0.75);
 backdrop-filter:blur(10px);
 border-bottom:1px solid rgba(255,255,255,0.12);
 padding:8px 0;
 z-index:999;
}

/* Animated Underline */
@keyframes glowline{
 from{opacity:.4;box-shadow:0 0 6px #4fffee;}
 to{opacity:1;box-shadow:0 0 16px #4fffee;}
}

/* Page space under header */
.spacer{ height:60px; }

</style>
</head>
<body>

<div id="header">
 <div style="max-width:1100px;margin:auto;display:flex;align-items:center;justify-content:space-between;padding:0 12px;">

   <!-- LOGO + BRAND -->
   <div style="display:flex;align-items:center;gap:10px;">
     <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="#4fffee" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
       <path d="M2 12s4-4 10-4 10 4 10 4-4 4-10 4-10-4-10-4z"/>
       <circle cx="12" cy="12" r="3"/>
     </svg>

     <div style="font-size:26px;font-weight:900;position:relative;
     background:linear-gradient(135deg,var(--aqua2),var(--aqua3));
     -webkit-background-clip:text;color:transparent;
     text-shadow:0 0 12px rgba(0,255,255,0.4);">
       AVS.MOHAN
       <div style="position:absolute;bottom:-4px;left:0;width:100%;height:2px;
       background:linear-gradient(90deg,transparent,#4fffee,transparent);
       border-radius:4px;animation:glowline 2.4s infinite alternate;"></div>
     </div>
   </div>

   <!-- STATUS INDICATOR -->
   <div id="conn-indicator" style="display:flex;align-items:center;gap:6px;font-size:14px;font-weight:700;">
     <div id="conn-dot" style="width:12px;height:12px;border-radius:50%;background:red;box-shadow:0 0 10px red;"></div>
     <span id="conn-text">Connecting...</span>
   </div>

 </div>
</div>

<div class="spacer"></div>

<div class="container">

<!-- ROW 1 -->
<div class="grid row-1">
 <div class="card small"><div class="title">ESP32</div><div class="icon" id="esp32-icon">üîå</div><div class="big-value" id="esp32-value">-</div></div>
 <div class="card small"><div class="title">MAIN POWER</div><div class="icon">‚ö°</div><div class="big-value" id="mp-value">-</div></div>
 <div class="card small"><div class="title">GEN POWER</div><div class="icon">‚õΩ</div><div class="big-value" id="gp-value">-</div></div>
 <div class="card small"><div class="title">GEN STATUS</div><div class="icon" id="gen-icon">üîÅ</div><div class="big-value" id="gen-value">-</div></div>
</div>

<div class="row-sep"></div>

<!-- PW -->
<div class="grid row-2">
 <div class="card small"><div class="title">PW ON</div><button class="glass-btn green" data-topic="AVSmohan/project1/PW" data-payload="ON">ON</button></div>
 <div class="card small"><div class="title">PW STATUS</div><div class="badge" id="pw-status">-</div></div>
 <div class="card small"><div class="title">PW OFF</div><button class="glass-btn red" data-topic="AVSmohan/project1/PW" data-payload="OFF">OFF</button></div>
</div>

<div class="row-sep"></div>

<!-- GM -->
<div class="grid row-2">
 <div class="card small"><div class="title">GM ON</div><button class="glass-btn green" data-topic="AVSmohan/project1/GM" data-payload="ON">ON</button></div>
 <div class="card small"><div class="title">GM STATUS</div><div class="badge" id="gm-status">-</div></div>
 <div class="card small"><div class="title">GM OFF</div><button class="glass-btn red" data-topic="AVSmohan/project1/GM" data-payload="OFF">OFF</button></div>
</div>

<div class="row-sep"></div>

<!-- GEN1 -->
<div class="grid row-2">
 <div class="card small"><div class="title">GEN1 ON</div><button class="glass-btn green" data-topic="AVSmohan/project1/relay/2" data-payload="ON">ON</button></div>
 <div class="card small"><div class="title">GEN1 STATUS</div><div class="badge" id="gen1-status">-</div></div>
 <div class="card small"><div class="title">GEN1 OFF</div><button class="glass-btn red" data-topic="AVSmohan/project1/relay/2" data-payload="OFF">OFF</button></div>
</div>

<div class="row-sep"></div>

<!-- FAN -->
<div class="grid row-2">
 <div class="card small"><div class="title">FAN ON</div><button class="glass-btn green" data-topic="AVSmohan/project1/relay/1" data-payload="ON">ON</button></div>
 <div class="card small"><div class="title">FAN STATUS</div><div class="badge" id="fan-status">-</div></div>
 <div class="card small"><div class="title">FAN OFF</div><button class="glass-btn red" data-topic="AVSmohan/project1/relay/1" data-payload="OFF">OFF</button></div>
</div>
</div>


<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<script>
const topics={
 esp32:'83095/esp32/status',
 mp:'83095/project1/MP',
 gp:'83095/project1/GP',
 gen:'83095/project11/generator/status',
 pw:'83095/project1/PW/status',
 gm:'83095/project1/GM/status',
 gen1:'83095/project1/relay/2',
 fan:'83095/project1/relay/1'
};

const connDot=document.getElementById("conn-dot");
const connText=document.getElementById("conn-text");

function setStatus(state){
 if(state==="online"){
   connDot.style.background="lime";
   connDot.style.boxShadow="0 0 10px lime";
   connText.textContent="OK";
 }else if(state==="connecting"){
   connDot.style.background="yellow";
   connDot.style.boxShadow="0 0 10px yellow";
   connText.textContent="...";
 }else{
   connDot.style.background="red";
   connDot.style.boxShadow="0 0 10px red";
   connText.textContent="OFF";
 }
}

function publish(topic,payload){
 if(!client.connected) return alert("Not connected!");
 client.publish(topic,String(payload),{qos:1,retain:true});
}

document.querySelectorAll("button[data-topic]").forEach(btn=>{
 btn.onclick=()=>publish(btn.dataset.topic,btn.dataset.payload);
});

function handle(t,m){
 if(t===topics.esp32) document.getElementById("esp32-value").textContent=m;
 if(t===topics.mp) document.getElementById("mp-value").textContent=m;
 if(t===topics.gp) document.getElementById("gp-value").textContent=m;
 if(t===topics.gen) document.getElementById("gen-value").textContent=m;
 if(t===topics.pw) document.getElementById("pw-status").textContent=m;
 if(t===topics.gm) document.getElementById("gm-status").textContent=m;
 if(t===topics.gen1) document.getElementById("gen1-status").textContent=m;
 if(t===topics.fan) document.getElementById("fan-status").textContent=m;
}

const protocol=location.protocol==="https:"?"wss":"ws";
const client=mqtt.connect(`${protocol}://broker.hivemq.com:${protocol==="wss"?8884:8000}/mqtt`,
 {clientId:"avs"+Math.random().toString(16).slice(2),reconnectPeriod:2000});

client.on("connect",()=>{
 setStatus("online");
 Object.values(topics).forEach(t=>client.subscribe(t));
});

client.on("reconnect",()=>setStatus("connecting"));
client.on("close",()=>setStatus("offline"));
client.on("message",(t,m)=>handle(t,m.toString()));

</script>
</body>
</html>
